const confirmation=()=>{$(".confirmation").toggleClass("hidden flex"),$(".inRequests").hasClass("absolute")?$(".header, .draft").toggleClass("blur"):$(".wrapper, .header, .draft").toggleClass("blur"),$(".wrapper *").removeClass("translateXbackwards")};$(".confirmation__body__cancel").click(()=>{smartHide(".confirmation","out")});const handleHomeBtnClick=(e,a)=>{$(`.home__${a}__${e}`).click(()=>{var a;"newRequest"===e&&"inRequests"===(a="inRequests")&&$(`.${a}__step1`).removeClass("hidden").addClass("flex"),$(".home").addClass("hidden").removeClass("flex"),$(".returnIcon, .header__container__msg").removeClass("hidden")})};handleHomeBtnClick("newRequest","btnContainer");const socket=io();let inRequestsReaderGender,data2send={table:"",values:[]};const capitalizeFirstLetter=e=>e.charAt(0).toUpperCase()+e.slice(1);let validationErr=!1;$(".returnIcon").click(()=>{const e=(e,a)=>{var t;e.match(/(step1|users|locations)/gi)?$(e).is(":visible")&&e.match(/inRequests__step1|users|locations/gi)&&(t=e,$(t).removeClass("translateXbackwards").toggleClass("translateXonwards hidden"),$(".home").toggleClass("hidden flex"),$(".returnIcon, .header__container__msg").addClass("hidden").removeClass("flex"),setTimeout(()=>{$(t).toggleClass("translateXonwards flex")},500)):$(e).is(":visible")&&($(e).addClass("translateXonwards hidden").removeClass("flex"),$(a).removeClass("translateXbackwards hidden").addClass("flex"))};e(".users"),e(".locations"),e(".inRequests__step1")}),$(".menu__item").click(()=>{$(".header__menu__switch").prop("checked")&&$(".header__menu__switch").prop("checked",!1)});const invalid=e=>{e.addClass("invalid"),validationErr=!0};socket.on("notification",e=>{"success"===e.type?($(".notification__icon").attr("src","./src/scss/icons/thumbs-up.svg"),$(".notification").removeClass("notificationInfo notificationMail notificationFailure").addClass("notificationSuccess"),$(".notification__msg").text("Changements enregistr√©s avec succ√®s ! üòâ")):"error"===e.type?($(".notification__icon").attr("src","./src/scss/icons/error.svg"),$(".notification").removeClass("notificationInfo notificationMail notificationSuccess").addClass("notificationFailure"),$(".notification__msg").text("Une erreur s'est produite... üò±")):"info"===e.type?($(".notification__icon").attr("src","./src/scss/icons/info.svg"),$(".notification").removeClass("notificationSuccess notificationMail notificationFailure").addClass("notificationInfo"),$(".notification__msg").text("Aucune donn√©e correspondante n'a √©t√© trouv√©e... üò∂")):"mail"===e.type&&($(".notification__icon").attr("src","./src/scss/icons/mail.svg"),$(".notification").removeClass("notificationInfo notificationSuccess notificationFailure").addClass("notificationMail"),$(".notification__msg").text("Mail envoy√© üòé")),$(".notification").removeClass("hidden").addClass("flex"),setTimeout(()=>{$(".notification").fadeOut((function(){$(this).removeAttr("style").removeClass("notificationSuccess notificationFailure notificationInfo flex").addClass("hidden")}))},5e3)});const smartHide=(e,a,t)=>{"in"===a?($(e).toggleClass("hidden flex"),$(".wrapper, .header").addClass("blur")):($(e).toggleClass("hidden flex"),$(".inRequests").hasClass("absolute")?$(".header").toggleClass("blur"):$(".wrapper, .header").toggleClass("blur"),void 0!==t&&clearTimeout(t))},setDate=()=>{$(".inRequests__form__requestInfo__row1__requestDate").val(`${(new Date).getFullYear()}-${setMonth(new Date)}-${setDay(new Date)}`)},setDay=e=>e.getDate()<10?"0"+e.getDate():e.getDate(),setMonth=e=>e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1;$(".inRequests__form__requestInfo__row1__requestDate").val(`${(new Date).getFullYear()}-${setMonth(new Date)}-${setDay(new Date)}`);const exportDB=()=>{let e="";$(".export__child__container__format input.radio").each((function(){$(this).is(":checked")&&(e=$(this).val())})),socket.emit("export db",e),e=""};let initialPibNb,initialBarcode;$(".exportsLink").click(()=>{smartHide(".export","in"),format=""}),$(".export .btn--submit").click(()=>{exportDB()}),$(".export .btn--reset").click(()=>{smartHide(".export","out")}),socket.on("export successfull",()=>{smartHide(".export","out"),window.open("/download")});const inRequests=()=>{let e,a=$(".inRequests__form__applicantInfo__name"),t=$(".inRequests__form__applicantInfo__firstname"),s=$(".inRequests__form__requestInfo__row1__requestDate"),n=$(".inRequests__form__requestInfo__comment"),_=$(".inRequests__form__requestInfo__row1__assignedWorker");$(".inRequests__form__btnContainer__submit").click(i=>{i.preventDefault();let o=$(".inRequests__form__applicantInfo__location option:selected");if(data2send.table="tasks",""===a.val()&&invalid(a),""===t.val()&&invalid(t),""===o.val()&&invalid(o),""===s.val()&&invalid(s),""===n.val()&&invalid(n),$(".inRequests").hasClass("absolute")&&""===_.val()&&invalid(_),validationErr){if(!$("form .warning").length){$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".inRequests__form")}validationErr=!1,data2send.values=[]}else $(".input").removeClass("invalid"),$("form .warning").hide(),confirmation(),e=setTimeout(()=>{a.val(a.val().replace(/'/g,"''")),t.val(t.val().replace(/'/g,"''")),o.val(o.val().replace(/'/g,"''")),n.val(n.val().replace(/'/g,"''")),$(".inRequests").hasClass("absolute")&&_.val(_.val().replace(/'/g,"''")),data2send.values.push(a.val()),data2send.values.push(t.val()),data2send.values.push(new Date(s.val()).toUTCString()),data2send.values.push(o.val()),data2send.values.push(n.val()),$(".inRequests").hasClass("absolute")?(data2send.values.push($(".inRequests__form__requestInfo__row1__status").val()),data2send.values.push(_.val())):(data2send.sendMail=$(".inRequests__form__requestInfo__row1__sendMail").is(":checked"),data2send.values.push("waiting")),$(".inRequests").hasClass("absolute")?(data2send.id=$(".inRequests.absolute .inRequests__id").text(),$(".inRequests.absolute").toggleClass("hidden flex"),$(".wrapper").toggleClass("backgroundColor blur"),socket.emit("update",data2send),$(".inRequests.absolute .inRequests__form__btnContainer__hide").toggleClass("hidden")):(socket.emit("append data",data2send),$(".home").toggleClass("hidden flex"),$(".header__container__icon, .header__container__msg").toggleClass("hidden"),data2send.sendMail&&socket.emit("send mail",{request:n.val(),applicant:{name:a.val(),firstname:t.val(),location:o.text()}})),$(".inRequests__form .input").not(".inRequests__form__requestInfo__row1__requestDate").val(""),confirmation(),data2send.values=[]},5e3)}),$(".inRequests__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]}),$(".confirmation__body__cancel").click(()=>{clearTimeout(e)})};let addLocationTimeout;inRequests(),$(".leaveLink").click(()=>{$(".wrapper, header").toggleClass("blur"),$(".leave").toggleClass("hidden flex"),$(".leave").click((function(e){e.target===this&&($(this).toggleClass("hidden flex"),$(".wrapper, header").removeClass("blur"))})),$(".shutdownBtn").click(()=>{socket.emit("shutdown")}),$(".restartBtn").click(()=>{socket.emit("restart"),setTimeout(()=>{location.reload()},1e4)})});const manageLocations=()=>{$(".addLocation__form").submit(()=>{event.preventDefault(),data2send.table="locations";let e=$(".addLocation__form__name input"),a=$(".addLocation__form__email input");if(""===e.val()&&invalid(e),(a.is(":invalid")||""===a.val())&&invalid(a),validationErr){if(!$("form .warning").length){$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".addLocation__form")}validationErr=!1,data2send.values=[]}else{const t=()=>{data2send.values.push(capitalizeFirstLetter(e.val())),data2send.values.push(a.val()),$(".addLocation").hasClass("absolute")&&$(".addLocation__title").text().match("Modification")?(data2send.id=$(".addLocation.absolute .addLocation__form__userID").val(),socket.emit("update",data2send)):socket.emit("append data",data2send),data2send.values=[],$(".addLocation").removeAttr("style").toggleClass("hidden flex"),$(".addLocation input").val(""),confirmation(),$(".locations").removeClass("blur backgroundColor"),$(".header__container__icon, .header__container__msg").toggleClass("hidden")};$(".input").removeClass("invalid"),$("form .warning").addClass("hidden"),confirmation(),addLocationTimeout=setTimeout((function(){t()}),5e3)}}),$(".addLocation__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]}),$(".confirmation__body__cancel").click(()=>{clearTimeout(addLocationTimeout)})};$(".addLocation__form").submit(()=>{event.preventDefault(),data2send.table="locations";let e=$(".addLocation__form__name input"),a=$(".addLocation__form__email input");if(""===e.val()&&invalid(e),(a.is(":invalid")||""===a.val())&&invalid(a),validationErr)$("form .warning").length||$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".addLocation__form"),validationErr=!1,data2send.values=[];else{const t=()=>{data2send.values.push(capitalizeFirstLetter(e.val())),data2send.values.push(a.val()),$(".addLocation").hasClass("absolute")&&$(".addLocation__title").text().match("Modification")?(data2send.id=$(".addLocation.absolute .addLocation__form__userID").val(),socket.emit("update",data2send)):socket.emit("append data",data2send),data2send.values=[],$(".addLocation").removeAttr("style").toggleClass("hidden flex"),$(".addLocation input").val(""),confirmation(),$(".locations").removeClass("blur backgroundColor"),$(".header__container__icon, .header__container__msg").toggleClass("hidden")};$(".input").removeClass("invalid"),$("form .warning").addClass("hidden"),confirmation(),addLocationTimeout=setTimeout((function(){t()}),5e3)}}),$(".addLocation__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]}),$(".confirmation__body__cancel").click(()=>{clearTimeout(addLocationTimeout)});let iDataRow=0;const appendUserRow=(e,a)=>{let t=$("<span></span>").addClass(`users__container__row users__container__row--${e} flex`).appendTo(".users__container");$("<span></span>").addClass("users__container__row__item users__container__row__item--id hidden").append(a.user_id).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--name").append(a.name.replace(/\'\'/g,"'")).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--firstname").append(a.firstname.replace(/\'\'/g,"'")).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--email").append(a.email).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--location").append(a.location_name).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--location_id hidden").append(a.location_id).appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--gender hidden").append(a.gender).appendTo(t),$("<input>").attr("type","password").addClass("users__container__row__item users__container__row__item--pwd input noInput").val("12345678").appendTo(t),$("<span></span>").addClass("users__container__row__item users__container__row__item--type").append(a.type).appendTo(t)},appendLocationRow=(e,a)=>{let t=$("<span></span>").addClass(`locations__container__row locations__container__row--${e} flex`).appendTo(".locations__container");$("<span></span>").addClass("locations__container__row__item locations__container__row__item--id hidden").append(a.location_id).appendTo(t),$("<span></span>").addClass("locations__container__row__item locations__container__row__item--name").append(a.location_name.replace(/\'\'/g,"'")).appendTo(t),$("<span></span>").addClass("locations__container__row__item locations__container__row__item--email").append(a.location_mail).appendTo(t)},toggleHeader=()=>$(".header__container").toggleClass("hidden flex"),manageUsers=(e,a)=>{let t;const s=()=>{$(`.${e}.absolute .${e}__form__btnContainer__hide`).click((function(){console.log("ok"),$("."+e).removeClass("absolute zero flex").addClass("hidden"),$("."+a).removeClass("blur backgroundColor"),$(this).addClass("hidden")}))};$(`.${a}Link`).click(()=>{$("."+a).hasClass("hidden")&&$(".home").removeClass("flex").addClass("hidden");const e=e=>{$("."+e).is(":visible")&&$("."+e).removeClass("flex").addClass("hidden")},t=e=>{$("."+e).is(":visible")||$("."+e).removeClass("hidden").addClass("flex")};t("returnIcon"),t("header__container__msg"),"users"===a?(e("locations"),t("users")):(e("users"),t("locations")),socket.emit("get "+a)}),socket.on(a+" retrieved",e=>{if($(`.${a}__container`).empty((function(){$(this).fadeOut()})),void 0!==e[0]){let s=$("<span></span>").addClass(a+"__container__header flex").appendTo(`.${a}__container`);for(const[t,n]of Object.keys(e[0]).entries()){let e=n;if("users"===a)switch(n){case"name":e="Nom";break;case"firstname":e="Pr√©nom";break;case"email":e="Adresse email";break;case"location":e="Implantation";break;case"password":e="Mot de passe";break;case"type":e="Type de compte";break;default:e=""}else switch(n){case"location_name":e="Nom";break;case"location_mail":e="Adresse email";break;default:e=""}if(""!==e){$("<span></span>").addClass(a+"__container__header__item").text(e).appendTo(s)}}for(const[t,s]of e.entries())"users"===a?appendUserRow(t,s):appendLocationRow(t,s),t===e.length-1&&(iDataRow=t+1);$(`.${a}__container`).fadeIn(),$(".context").length&&$(`.${a}__container__row`).contextmenu((function(e){$(".context").css({left:e.pageX+"px",top:e.pageY+"px"}).toggleClass("hidden flex"),t=$(this).attr("class").split(" ")[1],e.preventDefault(),$(`.${a}, .${a} *`).click((function(e){e.target===this&&$(".context").removeClass("flex").addClass("hidden")}))}))}}),$(".context__list__item").click(()=>{$(".context").removeClass("flex").addClass("hidden")}),$(".context__list__item--modify").click((function(){let n;$(".users").hasClass("flex")?($(".register").addClass("absolute zero flex").removeClass("hidden"),$(".users").addClass("blur backgroundColor")):$(".locations").hasClass("flex")&&($(".addLocation").addClass("absolute zero flex").removeClass("hidden"),$(".locations").addClass("blur backgroundColor")),toggleHeader(),s(),n="users"===a?"Modification de l'utilisateur":"Modification de l'implantation",$(`.${e}__title`).text(`${n} ${$(`.${t} .${a}__container__row__item--firstname`).text()}\n      ${$(`.${t} .${a}__container__row__item--name`).text()}`),$(`.${e}.absolute .${e}__form__userID`).val($(`.${t} .${a}__container__row__item--id`).text()),$(`.${e}.absolute .${e}__form__name input`).val($(`.${t} .${a}__container__row__item--name`).text()),$(`.${e}.absolute .${e}__form__email input`).val($(`.${t} .${a}__container__row__item--email`).text()),"users"===a&&($(".register.absolute .register__form__password input").attr("placeholder","Mot de passe inchang√©"),$(`.${e}.absolute .${e}__form__userFirstName input`).val($(`.${t} .${a}__container__row__item--firstname`).text()),$(`.${e}.absolute .${e}__form__location select`).val($(`.${t} .${a}__container__row__item--location_id`).text()),$(`.${e}.absolute .${e}__form__type select`).val($(`.${t} .${a}__container__row__item--type`).text()),"m"===$(`.${t} .${a}__container__row__item--gender`).text()?$(`.${e}.absolute .${e}__form__male input`).attr("checked",!0):$(`.${e}.absolute .${e}__form__female input`).attr("checked",!0)),$(`.${e}.absolute .${e}__form__btnContainer__submit`).click(()=>{$(`.${t} .${a}__container__row__item--name`).text($(`.${e}__form__name input`).val().replace(/\'\'/g,"'")),$(`.${t} .${a}__container__row__item--email`).text($(`.${e}__form__email input`).val()),"users"===a&&($(`.${t} .${a}__container__row__item--firstname`).text($(`.${e}__form__userFirstName input`).val().replace(/\'\'/g,"'")),$(`.${t} .${a}__container__row__item--location`).text($(`.${e}__form__location option:selected`).text().replace(/\'\'/g,"'")),$(`.${t} .${a}__container__row__item--type`).text($(`.${e}__form__type option:selected`).val()))})})),$(".context__list__item--del").click((function(){let e={key:$(`.${t} .${a}__container__row__item--id`).text(),table:a};confirmation(),$("."+t).toggleClass("hidden flex"),recordDelTimeOut=setTimeout(()=>{$("."+t).remove(),confirmation(),socket.emit("delete data",e),e={}},5e3),$(".confirmation__body__cancel").click(()=>{clearTimeout(recordDelTimeOut),$("."+t).removeClass("hidden").addClass("flex"),recordDelTimeOut=void 0,e={}})})),$(`.${a}__header__addBtn`).click((function(){toggleHeader(),$("."+a).addClass("blur backgroundColor"),$(`.${e} input`).not(".radio").val(""),$(".register select").val("default"),$(".register .warning, .addLocation .warning").hide(),$(".input").removeClass("invalid"),"users"===a?$(".register__title").text("Ajouter un utilisateur"):$(".addLocation__title").text("Ajouter une implantation"),$("."+e).addClass("absolute zero flex").removeClass("hidden"),s()})),$(`.${e}.absolute .${e}__form__btnContainer__submit`).click((function(){toggleHeader(),$("."+e).removeClass("absolute zero flex").addClass("hidden"),$("."+a).removeClass("blur backgroundColor")}))};manageUsers("register","users"),manageUsers("addLocation","locations");const register=()=>{let e,a=$(".register__form__name input"),t=$(".register__form__userFirstName input"),s=$(".register__form__password input"),n=$(".register__form__email input");$(".register__form__btnContainer__submit").click(_=>{_.preventDefault(),data2send.table="users";let i="",o=$(".register__form__location option:selected").val(),r=$(".register__form__type option:selected").val();if($(".register__form__gender input.radio").each((function(){$(this).is(":checked")&&(i=$(this).val())})),""===a.val()&&invalid(a),""===t.val()&&invalid(t),"default"===o&&invalid($(".register__form__location .input")),$(".register").hasClass("absolute")&&$(".register__title").text().match("Modification")||""===s.val()&&invalid(s),(n.is(":invalid")||""===n.val())&&invalid(n),"default"===r&&invalid($(".register__form__type .input")),""===i&&invalid($(".register__form__gender input.radio")),validationErr){if(!$("form .warning").length){$("<span></span>").addClass("warning").text("Certains champs sont incorrects...").appendTo(".register__form")}validationErr=!1,data2send.values=[]}else{const _=()=>{data2send.setPassword=!0,data2send.values.push(capitalizeFirstLetter(a.val())),data2send.values.push(capitalizeFirstLetter(t.val())),data2send.values.push(n.val()),data2send.values.push(o),data2send.values.push(i),data2send.values.push(r),$(".register").hasClass("absolute")&&$(".register__title").text().match("Modification")?(data2send.id=$(".register.absolute .register__form__userID").val(),""!==s.val()?(data2send.setPassword=!0,data2send.values.push(s.val())):data2send.setPassword=!1,socket.emit("update",data2send),s.attr("placeholder","Ins√©rez le mot magique")):(data2send.values.push(s.val()),socket.emit("append data",data2send)),data2send.values=[],$(".register").removeAttr("style").toggleClass("hidden flex"),$(".register input").not(".radio").val(""),"/"===window.location.pathname&&(confirmation(),$(".users").removeClass("blur backgroundColor"),$(".header__container__icon, .header__container__msg").toggleClass("hidden"))};$(".input").removeClass("invalid"),$("form .warning").addClass("hidden"),"/"===window.location.pathname?(confirmation(),e=setTimeout((function(){_()}),5e3)):_()}}),$(".register__form__btnContainer__reset").click(()=>{$(".input").removeClass("invalid"),$("form .warning").hide(),validationErr=!1,data2send.values=[]}),$(".confirmation__body__cancel").click(()=>{clearTimeout(e)})};socket.on("first user added",()=>{window.location.reload()}),register();const search=()=>{let e,a={table:"",applicant_name:"",getApplicant:!1};$(".search__container").submit(e=>{e.preventDefault(),a.getApplicant=!1,"default"!==$(".search__container__select").val()&&(a.location=$(".search__container__select").val(),""!==$(".search__container__readerInput").val()&&(a.applicant_name=$(".search__container__readerInput").val().replace(/\'/g,"''")),socket.emit("search",a),a.location=a.applicant_name="",a.getApplicant=!1)}),socket.on("search results",a=>{let t;if($(".search__results__container").empty((function(){$(this).fadeOut()})),void 0!==a[0]){let s=$("<span></span>").addClass("search__results__container__header flex").appendTo(".search__results__container");for(const[e,t]of Object.keys(a[0]).entries()){let e=t;switch(t){case"task_id":e="N¬∞ de demande";break;case"applicant_name":e="Nom du demandeur";break;case"applicant_firstname":e="Pr√©nom du demandeur";break;case"request_date":e="Date";break;case"comment":e="Contenu de la demande";break;case"status":e="Statut";break;case"user_fk":e="Attribution";break;default:e=""}if(""!==e){$("<span></span>").addClass("search__results__container__header__item").text(e).appendTo(s)}}for(const[e,t]of a.entries()){let a=$("<span></span>").addClass(`search__results__container__row search__results__container__row--${e} flex`).appendTo(".search__results__container"),s=($("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--id").append(t.task_id).appendTo(a),$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--name").append(t.applicant_name.replace(/\'\'/g,"'")).appendTo(a),$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--firstname").append(t.applicant_firstname.replace(/\'\'/g,"'")).appendTo(a),$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--date")),n=$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--timestamp hidden");null!==t.request_date?(s.append(new Date(t.request_date).toLocaleDateString()),n.append(t.request_date.split("T")[0])):s.append("Probl√®me d'affichage..."),n.appendTo(a),s.appendTo(a);let _=$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--aw").appendTo(a);$("<span></span>").addClass("search__results__container__row__item search__results__container__row__item--body").append(t.comment.replace(/\n/gi,"<br>")).appendTo(a);if(void 0!==t.user_fk&&null!==t.user_fk){_.append(`${t.name.toUpperCase()}, ${t.firstname}`);$("<span></span>").addClass("search__results__container__row__item--awid hidden").append(t.user_fk).appendTo(a)}else null===t.user_fk?_.append("Non attribu√©"):(_.append("Probl√®me d'affichage :(("),console.log(`Assigned worker for task n¬∞${t.task_id} : ${t.name.toUpperCase()}, ${t.firstname}`));let i=$('      <svg xmlns="http://www.w3.org/2000/svg">        <circle cx="50%" cy="50%" r="5"/>        <title class="status__title"></title>      </svg>      ').addClass("search__results__container__row__item search__results__container__row__item--status").attr("viewBox","0 0 75 10").appendTo(a);"waiting"===t.status?(i.removeClass("done wip").addClass("waiting"),$(`.${i.attr("class").split(" ").join(".")} .status__title`).text("En attente d'attribution")):"done"===t.status?(i.removeClass("waiting wip").addClass("done"),$(`.${i.attr("class").split(" ").join(".")} .status__title`).text("Termin√©e")):(i.removeClass("done waiting").addClass("wip"),$(`.${i.attr("class").split(" ").join(".")} .status__title`).text("En cours de traitement"))}$(".search__results__container").fadeIn(),$(".context").length&&($(".search__results__container__row").contextmenu((function(e){$(".context").css({left:e.pageX+"px",top:e.pageY+"px"}).toggleClass("hidden flex"),t=$(this).attr("class").split(" ")[1],e.preventDefault(),$(".search__results, .search__results *").click((function(e){e.target===this&&$(".context").removeClass("flex").addClass("hidden")}))})),$(".context__list__item").click(()=>{$(".context").removeClass("flex").addClass("hidden")}),$(".context__list__item--modify").click((function(){let e=$(`.${t} .search__results__container__row__item--timestamp`).text();$(".wrapper").addClass("blur"),$(".inRequests").addClass("absolute flex").removeClass("hidden"),$(".inRequests.absolute .inRequests__form__btnContainer__hide, .inRequests__form__requestInfo__row1__assignedWorker, .inRequests.absolute .inRequests__form__requestInfo__row1__status").removeClass("hidden").addClass("flex"),$(".inRequests__form__applicantInfo__location, .inRequests__form__requestInfo__row1 label").addClass("hidden").removeClass("flex"),$(".inRequests.absolute .inRequests__id").text($(`.${t} .search__results__container__row__item--id`).text()),$(".inRequests.absolute .inRequests__form__applicantInfo__location").val($(".search__container__select").val()),$(".inRequests.absolute .inRequests__form__applicantInfo__name").val($(`.${t} .search__results__container__row__item--name`).text()),$(".inRequests.absolute .inRequests__form__applicantInfo__firstname").val($(`.${t} .search__results__container__row__item--firstname`).text()),$(".inRequests.absolute .inRequests__form__requestInfo__row1__requestDate").val(e),$(".inRequests.absolute .inRequests__form__requestInfo__comment").val($(`.${t} .search__results__container__row__item--body`).text().replace("<br>","\n")),$(".inRequests.absolute .inRequests__form__requestInfo__row1__assignedWorker").val($(`.${t} .search__results__container__row__item--awid`).text()),$(`.${t} .search__results__container__row__item--status`).hasClass("wip")?$(".inRequests.absolute .inRequests__form__requestInfo__row1__status").val("wip"):$(`.${t} .search__results__container__row__item--status`).hasClass("waiting")?$(".inRequests.absolute .inRequests__form__requestInfo__row1__status").val("waiting"):$(".inRequests.absolute .inRequests__form__requestInfo__row1__status").val("done"),$(".inRequests.absolute .inRequests__form__btnContainer__submit").click(()=>{$(`.${t} .search__results__container__row__item--name`).text($(".inRequests__form__applicantInfo__name").val().replace(/\'\'/g,"'")),$(`.${t} .search__results__container__row__item--firstname`).text($(".inRequests__form__applicantInfo__firstname").val().replace(/\'\'/g,"'")),$(`.${t} .search__results__container__row__item--date`).text(new Date($(".inRequests__form__requestInfo__row1__requestDate").val()).toLocaleDateString()),$(`.${t} .search__results__container__row__item--location`).text($(".inRequests__form__applicantInfo__location option:selected").text().replace(/\'\'/g,"'")),$(`.${t} .search__results__container__row__item--body`).text($(".inRequests__form__requestInfo__comment").val().replace("\n","<br>")),$(`.${t} .search__results__container__row__item--aw`).text($(".inRequests__form__requestInfo__row1__assignedWorker option:selected").text().replace(/\'\'/g,"'")),$(`.${t} .search__results__container__row__item--status`).removeClass("waiting wip done").addClass($(".inRequests.absolute .inRequests__form__requestInfo__row1__status").val())}),$(".inRequests.absolute .inRequests__form__btnContainer__hide").click((function(){$(".inRequests").removeClass("absolute flex").addClass("hidden"),$(".wrapper").removeClass("blur backgroundColor"),$(this).addClass("hidden")}))})),$(".context__list__item--del").click((function(){let a={key:$(`.${t} .search__results__container__row__item--id`).text(),table:"tasks"};confirmation(),$("."+t).toggleClass("hidden flex"),e=setTimeout(()=>{$("."+t).remove(),confirmation(),socket.emit("delete data",a),a={}},5e3),$(".confirmation__body__cancel").click(()=>{clearTimeout(e),$("."+t).removeClass("hidden").addClass("flex"),e=void 0,a={}})})))}})};search();const showAbout=()=>{$(".aboutLink").click(()=>{$(".wrapper, header").toggleClass("blur"),$(".about__container").toggleClass("hidden flex")}),$(".updateBtn").click(()=>{socket.emit("update check")}),socket.on("update progress",e=>{$(".updateBtn").text(e)}),$(".about__container").click((function(e){e.target===this&&($(this).toggleClass("hidden flex"),$(".wrapper, header").removeClass("blur"))}))};showAbout();